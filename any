public static void updateProductSequence(Id productCollectionId) {
    // Step 1: Query items related to the collection
    List<ProductCollectionItem__c> items = [
        SELECT Id, Product2__c, Sequence__c
        FROM ProductCollectionItem__c
        WHERE ProductCollection__c = :productCollectionId
        ORDER BY Product2__r.Name ASC
    ];

    // Step 2: Assign new sequence numbers
    Integer counter = 1;
    for (ProductCollectionItem__c item : items) {
        item.Sequence__c = counter++;
    }

    // Step 3: Update the records
    if (!items.isEmpty()) {
        update items;
    }
}
